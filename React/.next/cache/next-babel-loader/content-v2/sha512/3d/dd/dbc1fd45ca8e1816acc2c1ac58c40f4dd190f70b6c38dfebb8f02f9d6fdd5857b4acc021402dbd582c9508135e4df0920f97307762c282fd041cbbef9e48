{"ast":null,"code":"import Liberacion from '../../../../models/Individualizacion';\nimport { liberacionesApi } from '../services';\nimport { OperacionesCatalogo } from '../../../../constants';\n\nasync function fetchFullModel(selectedLiberacionesRow) {\n  if (!selectedLiberacionesRow) {\n    return null;\n  }\n\n  let liberacion = new Liberacion(selectedLiberacionesRow.idFideicomiso, selectedLiberacionesRow.idSubcuenta, selectedLiberacionesRow.idBien, selectedLiberacionesRow.idEdificio, selectedLiberacionesRow.idDepto);\n  return await liberacionesApi.findByPK(liberacion);\n}\n\nfunction selectLiberacionesRow(selectedRow) {\n  return async dispatch => {\n    dispatch({\n      type: 'SELECT_LIBERACIONES_RESULT_ROW',\n      selectedRow: selectedRow\n    });\n  };\n}\n\nfunction fetchAndDisplayModel(mode) {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const loadedModel = await fetchFullModel(state.Liberaciones.selectedRow);\n\n    if (loadedModel !== null) {\n      dispatch({\n        type: 'SET_LIBERACIONES_MODEL',\n        model: loadedModel\n      });\n    }\n\n    dispatch({\n      type: 'OPEN_LIBERACIONES_MODAL',\n      mode: mode\n    });\n  };\n}\n\nfunction newSearchLiberaciones(parameters) {\n  return async dispatch => {\n    dispatch({\n      type: 'SET_LIBERACIONES_SEARCH_PARAMETERS',\n      searchParameters: parameters\n    });\n    await searchLiberaciones(dispatch, parameters);\n  };\n}\n\nasync function searchLiberaciones(dispatch, parameters) {\n  const Liberaciones = await liberacionesApi.find(parameters);\n  dispatch({\n    type: 'SET_LIBERACIONES_SEARCH_RESULTS',\n    results: Liberaciones\n  });\n}\n\nasync function repeatCurrentSearch(dispatch, getState) {\n  const state = getState();\n  return await searchLiberaciones(dispatch, state.Liberaciones.searchParameters);\n}\n\nfunction saveModel(model) {\n  return async (dispatch, getState) => {\n    const state = getState();\n    dispatch({\n      type: 'SAVE_LIBERACIONES_MODEL'\n    });\n\n    try {\n      if (state.Liberaciones.modalMode === OperacionesCatalogo.Alta) {\n        await liberacionesApi.create(model);\n      } else {\n        await liberacionesApi.update(model);\n      }\n\n      dispatch({\n        type: 'SET_MODEL_SAVE_SUCCESS'\n      });\n      repeatCurrentSearch(dispatch, getState);\n    } catch (err) {\n      dispatch({\n        type: 'SET_MODEL_SAVE_ERROR',\n        error: err.message\n      });\n    }\n  };\n}\n\nfunction deleteSelectedModel() {\n  return async (dispatch, getState) => {\n    const state = getState();\n\n    if (!state.Liberaciones.selectedRow) {\n      return;\n    }\n\n    const model = liberacionesApi.getModelFromResultRow(state.Liberaciones.selectedRow);\n    await liberacionesApi.destroy(model);\n    await repeatCurrentSearch(dispatch, getState);\n  };\n}\n\nexport default {\n  selectLiberacionesRow,\n  fetchAndDisplayModel,\n  newSearchLiberaciones,\n  saveModel,\n  deleteSelectedModel\n};","map":null,"metadata":{},"sourceType":"module"}