{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect, useContext } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport { SortTypes } from './types';\nimport GenericTableRow from './GenericTableRow';\nimport GenericTableToolbar from './GenericTableToolbar';\nimport GenericTableHead from './GenericTableHead';\nimport { GenericTableCallbacksContext } from './context';\nimport ExcelTransformer from '../../services/ExcelTransformer';\nconst ROW_HEIGHT = 53;\nconst useStyles = makeStyles(theme => {\n  return {\n    root: {\n      width: '100%',\n      marginBottom: theme.spacing(2)\n    },\n    table: {\n      width: '100%'\n    }\n  };\n});\n\nfunction toggleSelectedElementInList(selectedElements, row) {\n  if (selectedElements.has(row)) {\n    selectedElements.delete(row);\n  } else {\n    selectedElements.add(row);\n  }\n\n  return new Set(selectedElements);\n}\n\nfunction rowsDisplayedFormatter(props) {\n  const {\n    from,\n    to,\n    count\n  } = props;\n  return `${from}-${to === -1 ? count : to} de ${count !== -1 ? count : 'mÃ¡s de' + to}`;\n}\n\nfunction GenericTable(props) {\n  const {\n    onNew,\n    multipleSelect = true\n  } = props;\n  const {\n    onSelect\n  } = useContext(GenericTableCallbacksContext);\n  const onSelectHandler = props.onSelect || onSelect;\n  const {\n    title,\n    data,\n    tableId,\n    columns = [],\n    showActionsHeader = true,\n    additionalActionsComponent = null\n  } = props;\n  const keyColum = columns[0].field;\n  const [order, setOrder] = React.useState(SortTypes.Asc);\n  const [orderBy, setOrderBy] = React.useState(keyColum);\n  const [page, setPage] = React.useState(0);\n  const [selectedRows, setSelectedRows] = React.useState(new Set());\n  const [rowsPerPage, setRowsPerPage] = React.useState(5);\n  const classes = useStyles();\n\n  const isSelected = row => selectedRows.has(row);\n\n  const currentRows = data.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage);\n  useEffect(() => {\n    setSelectedRows(new Set());\n  }, [data]);\n\n  function handleClick(row) {\n    if (multipleSelect) {\n      let newSelectedSet = toggleSelectedElementInList(selectedRows, row);\n      setSelectedRows(newSelectedSet);\n      onSelectHandler(Array.from(newSelectedSet));\n    } else {\n      setSelectedRows(new Set([row]));\n      onSelectHandler([row]);\n    }\n  }\n\n  const rows = currentRows.map(row => {\n    return __jsx(GenericTableRow, {\n      key: row.uniqueKey,\n      uniqueKey: row.uniqueKey,\n      row: row,\n      isSelected: isSelected(row),\n      onClick: handleClick,\n      columns: columns,\n      useCheckbox: multipleSelect\n    });\n  });\n  const emptyRowsCount = rowsPerPage - currentRows.length;\n  let emptyRowsPlaceholder = null;\n\n  if (emptyRowsCount > 0) {\n    emptyRowsPlaceholder = __jsx(TableRow, {\n      style: {\n        height: ROW_HEIGHT * emptyRowsCount\n      }\n    }, __jsx(TableCell, {\n      colSpan: columns.length + 1\n    }));\n  }\n\n  const handleRequestSort = property => {\n    const isAsc = orderBy === property && order === SortTypes.Asc;\n    setOrder(isAsc ? SortTypes.Asc : SortTypes.Desc);\n    setOrderBy(property);\n  };\n\n  const handleSelectAllClick = checked => {\n    if (checked) {\n      setSelectedRows(new Set(currentRows));\n      return;\n    }\n\n    setSelectedRows(new Set());\n  };\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = event => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const downloadHandler = () => {\n    new ExcelTransformer(data, columns, title, title).download(); //console.log('exportedExcel', exportedExcel);\n  };\n\n  return __jsx(Paper, {\n    className: classes.root,\n    elevation: 3\n  }, __jsx(GenericTableToolbar, {\n    numSelected: selectedRows.size,\n    title: title,\n    onNew: onNew,\n    onDownload: downloadHandler,\n    showActions: showActionsHeader,\n    multipleSelect: multipleSelect,\n    actionsComponent: additionalActionsComponent\n  }), __jsx(TableContainer, {\n    className: classes.table\n  }, __jsx(Table, {\n    id: tableId\n  }, __jsx(GenericTableHead, {\n    columns: columns,\n    numSelected: selectedRows.size,\n    order: order,\n    orderBy: orderBy,\n    onSelectAllClick: handleSelectAllClick,\n    onRequestSort: handleRequestSort,\n    rowCount: rows.length,\n    multipleSelect: multipleSelect\n  }), __jsx(TableBody, null, rows, emptyRowsPlaceholder))), __jsx(TablePagination, {\n    rowsPerPageOptions: [5, 10, 25],\n    labelRowsPerPage: \"Resultados por p\\xE1gina:\",\n    labelDisplayedRows: rowsDisplayedFormatter,\n    component: \"div\",\n    count: data.length,\n    rowsPerPage: rowsPerPage,\n    page: page,\n    onChangePage: handleChangePage,\n    onChangeRowsPerPage: handleChangeRowsPerPage\n  }));\n}\n\nexport default GenericTable;","map":null,"metadata":{},"sourceType":"module"}