{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar uri = 'data:application/vnd.ms-excel;base64,';\n\nvar ExcelTransformer = /*#__PURE__*/function () {\n  function ExcelTransformer(rows, layout, docname, filename) {\n    _classCallCheck(this, ExcelTransformer);\n\n    _defineProperty(this, \"rows\", void 0);\n\n    _defineProperty(this, \"layout\", void 0);\n\n    _defineProperty(this, \"docname\", void 0);\n\n    _defineProperty(this, \"filename\", void 0);\n\n    this.rows = rows;\n    this.layout = layout;\n    this.docname = docname;\n    this.filename = \"\".concat(String(filename), \".xls\");\n  }\n\n  _createClass(ExcelTransformer, [{\n    key: \"toHtml\",\n    value: function toHtml() {\n      var _this = this;\n\n      var headers = this.layout.map(function (columns) {\n        return \"<th>\".concat(columns.header, \"</th>\");\n      });\n      var tableHead = \"<thead><tr>\".concat(headers.join(''), \"</tr></thead>\");\n      var rows = this.rows.map(function (row) {\n        var rowColumns = _this.layout.map(function (column) {\n          var cellValue = row[column.field];\n          return \"<td>\".concat(cellValue == null ? '' : cellValue, \"</td>\");\n        });\n\n        return \"<tr>\".concat(rowColumns.join(''), \"</tr>\");\n      });\n      var tableBody = \"<tbody>\".concat(rows.join(''), \"</tbody>\");\n      var table = \"<table>\".concat(tableHead).concat(tableBody, \"</table>\");\n      return table;\n    }\n  }, {\n    key: \"toXls\",\n    value: function toXls() {\n      var xlsTemplate = \"\\n            <html xmlns:o=\\\"urn:schemas-microsoft-com:office:office\\\" xmlns:x=\\\"urn:schemas-microsoft-com:office:excel\\\" xmlns=\\\"http://www.w3.org/TR/REC-html40\\\">\\n                <head>\\n                <meta charset=\\\"UTF-8\\\">\\n                    <!--[if gte mso 9]>\\n                        <xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>\".concat(this.docname, \"</x:Name><x:WorksheetOptions><x:DisplayGridlines/>\\n                        </x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml>\\n                    <![endif]-->\\n                </head>\\n                <body>\\n                    \").concat(this.toHtml(), \"\\n                </body>\\n            </html>\");\n      return xlsTemplate;\n    }\n  }, {\n    key: \"toBase64\",\n    value: function toBase64(data) {\n      return window.btoa(unescape(encodeURIComponent(data)));\n    }\n  }, {\n    key: \"download\",\n    value: function download() {\n      var element = window.document.createElement('a');\n      element.href = uri + this.toBase64(this.toXls());\n      element.download = this.filename;\n      document.body.appendChild(element);\n      element.click();\n      document.body.removeChild(element);\n    }\n  }]);\n\n  return ExcelTransformer;\n}();\n\nexport default ExcelTransformer;","map":null,"metadata":{},"sourceType":"module"}