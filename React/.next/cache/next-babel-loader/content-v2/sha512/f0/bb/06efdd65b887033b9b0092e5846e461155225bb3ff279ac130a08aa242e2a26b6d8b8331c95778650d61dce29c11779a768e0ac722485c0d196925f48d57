{"ast":null,"code":"function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst uri = 'data:application/vnd.ms-excel;base64,';\n\nclass ExcelTransformer {\n  constructor(rows, layout, docname, filename) {\n    _defineProperty(this, \"rows\", void 0);\n\n    _defineProperty(this, \"layout\", void 0);\n\n    _defineProperty(this, \"docname\", void 0);\n\n    _defineProperty(this, \"filename\", void 0);\n\n    this.rows = rows;\n    this.layout = layout;\n    this.docname = docname;\n    this.filename = `${String(filename)}.xls`;\n  }\n\n  toHtml() {\n    const headers = this.layout.map(columns => `<th>${columns.header}</th>`);\n    const tableHead = `<thead><tr>${headers.join('')}</tr></thead>`;\n    const rows = this.rows.map(row => {\n      const rowColumns = this.layout.map(column => {\n        const cellValue = row[column.field];\n        return `<td>${cellValue == null ? '' : cellValue}</td>`;\n      });\n      return `<tr>${rowColumns.join('')}</tr>`;\n    });\n    const tableBody = `<tbody>${rows.join('')}</tbody>`;\n    const table = `<table>${tableHead}${tableBody}</table>`;\n    return table;\n  }\n\n  toXls() {\n    const xlsTemplate = `\n            <html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\">\n                <head>\n                <meta charset=\"UTF-8\">\n                    <!--[if gte mso 9]>\n                        <xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${this.docname}</x:Name><x:WorksheetOptions><x:DisplayGridlines/>\n                        </x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml>\n                    <![endif]-->\n                </head>\n                <body>\n                    ${this.toHtml()}\n                </body>\n            </html>`;\n    return xlsTemplate;\n  }\n\n  toBase64(data) {\n    return window.btoa(unescape(encodeURIComponent(data)));\n  }\n\n  download() {\n    const element = window.document.createElement('a');\n    element.href = uri + this.toBase64(this.toXls());\n    element.download = this.filename;\n    document.body.appendChild(element);\n    element.click();\n    document.body.removeChild(element);\n  }\n\n}\n\nexport default ExcelTransformer;","map":null,"metadata":{},"sourceType":"module"}