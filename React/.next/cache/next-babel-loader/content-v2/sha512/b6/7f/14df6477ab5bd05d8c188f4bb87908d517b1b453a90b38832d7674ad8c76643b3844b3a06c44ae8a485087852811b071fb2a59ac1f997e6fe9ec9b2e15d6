{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport { Formik } from 'formik';\nimport * as Yup from 'yup';\nimport { OperacionesCatalogo, SavingStatus } from '../../../constants';\nimport { ClavesModuloBienes } from '../../../constants/bienes';\nimport CatalogDialog from '../../../sharedComponents/CatalogDialog';\nimport GenericSwitch from '../../../sharedComponents/GenericSwitch';\nimport GenericForm from '../../../sharedComponents/Forms';\nimport FormValidator, { ValidationHelpers } from '../../../services/FormValidator';\nimport { monedasApi } from '../../../core/api/monedas';\nimport { OperacionesCatalogoDetalleBienes } from './constants';\n\nvar _GenericForm = new GenericForm(),\n    FormTextField = _GenericForm.FormTextField,\n    FormSelectField = _GenericForm.FormSelectField,\n    FormCatalogSelectField = _GenericForm.FormCatalogSelectField,\n    FormDatePickerField = _GenericForm.FormDatePickerField; //TODO: Usar estilos genericos\n\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    rowSpacing: {\n      marginBottom: theme.spacing(2)\n    }\n  };\n});\n\nfunction castOperacionCatalogo(mode) {\n  switch (mode) {\n    case OperacionesCatalogoDetalleBienes.Registro:\n      return OperacionesCatalogo.Alta;\n\n    case OperacionesCatalogoDetalleBienes.Modificacion:\n    case OperacionesCatalogoDetalleBienes.Revaluacion:\n      return OperacionesCatalogo.Modificacion;\n\n    case OperacionesCatalogoDetalleBienes.Consulta:\n      return OperacionesCatalogo.Consulta;\n\n    default:\n      return OperacionesCatalogo.Baja;\n  }\n}\n\nvar DialogDetalleBienes = function DialogDetalleBienes(_ref) {\n  var mode = _ref.mode,\n      model = _ref.model,\n      open = _ref.open,\n      errorMessage = _ref.errorMessage,\n      savingStatus = _ref.savingStatus,\n      onClose = _ref.onClose,\n      onSaveRequest = _ref.onSaveRequest,\n      onRevaluacion = _ref.onRevaluacion;\n  var esRevaluacion = mode === OperacionesCatalogoDetalleBienes.Revaluacion;\n\n  function handleSave(formData) {\n    if (esRevaluacion) {\n      onRevaluacion(formData.model, formData.datosRevaluacion);\n      return;\n    }\n\n    onSaveRequest(formData.model);\n  }\n\n  var DetalleBienesFormValidator = useMemo(function () {\n    if (esRevaluacion) {\n      return new FormValidator({\n        datosRevaluacion: Yup.object().shape({\n          importeRevaluacion: ValidationHelpers.validateRequiredNumber('Importe'),\n          fechaRevaluacion: Yup.date().required(ValidationHelpers.requiredFieldMessage('Fecha Revaluacion'))\n        })\n      });\n    }\n\n    return new FormValidator({\n      model: Yup.object().shape({\n        idTipoDetalleBien: ValidationHelpers.validateRequiredNumber('Tipo de bien'),\n        importeDelBien: ValidationHelpers.validateRequiredNumber('Importe del bien'),\n        idMoneda: ValidationHelpers.validateRequiredNumber('Moneda')\n      })\n    });\n  }, [esRevaluacion]);\n\n  var _useState = useState([]),\n      monedas = _useState[0],\n      setMonedas = _useState[1];\n\n  var classes = useStyles();\n  var allFieldsDisabled = mode === OperacionesCatalogoDetalleBienes.Consulta || mode === OperacionesCatalogoDetalleBienes.Revaluacion;\n  var pkFieldsDisabled = mode !== OperacionesCatalogoDetalleBienes.Registro;\n  var revaluacionFieldsDisabled = mode === OperacionesCatalogoDetalleBienes.Consulta || mode !== OperacionesCatalogoDetalleBienes.Revaluacion;\n  useEffect(function () {\n    monedasApi.fetchAll().then(function (monedas) {\n      setMonedas(monedas);\n    });\n  }, []);\n  var initialValues = {\n    model: model,\n    datosRevaluacion: {\n      importeRevaluacion: null,\n      fechaRevaluacion: new Date()\n    }\n  };\n  return __jsx(Formik, {\n    initialValues: initialValues,\n    onSubmit: handleSave,\n    enableReinitialize: true,\n    validationSchema: DetalleBienesFormValidator.validationSchema\n  }, function (props) {\n    return __jsx(CatalogDialog, {\n      opened: open,\n      operacionCatalogo: castOperacionCatalogo(mode),\n      nombreCatalogo: \"Detalle Bienes\",\n      subtitle: \"Detalle del Bien\",\n      onCancel: function onCancel() {\n        props.resetForm();\n        onClose();\n      },\n      onAccept: props.handleSubmit,\n      errorMessage: errorMessage,\n      saving: savingStatus === SavingStatus.Saving,\n      success: savingStatus === SavingStatus.Success\n    }, __jsx(Grid, {\n      container: true,\n      spacing: 1,\n      direction: \"column\",\n      className: classes.rowSpacing\n    }, __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"idFideicomiso\",\n      label: \"Fideicomiso\",\n      dataType: \"text\",\n      disabled: true\n    })), __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormCatalogSelectField, {\n      namespace: \"model\",\n      name: \"idTipoBien\",\n      catalogId: ClavesModuloBienes.TiposDeBienes,\n      label: \"Tipo Bien\",\n      disabled: true\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"idSubcuenta\",\n      label: \"Subcuenta\",\n      disabled: true\n    })), __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"idDetalleBien\",\n      label: \"Id Detalle Bien\",\n      disabled: true\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormCatalogSelectField, {\n      namespace: \"model\",\n      name: \"idTipoDetalleBien\",\n      parentCatalogId: ClavesModuloBienes.TiposDeBienes,\n      parentValue: props.values.model.idTipoBien,\n      label: \"Clave de Bien\",\n      disabled: pkFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"idRegimen\",\n      label: \"Bajo Regimen en Condominio\",\n      disabled: allFieldsDisabled\n    })), __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"importeDelBien\",\n      label: \"Importe\",\n      dataType: \"text\",\n      adornment: \"$\",\n      disabled: allFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 12\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"descripcion\",\n      label: \"Descripci\\xF3n\",\n      disabled: allFieldsDisabled,\n      multiline: true,\n      rows: 3,\n      rowsMax: 3\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"importeUltimaValuacion\",\n      label: \"Importe \\xDAltima Valuaci\\xF3n\",\n      dataType: \"text\",\n      adornment: \"$\",\n      disabled: true\n    })), __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormSelectField, {\n      namespace: \"model\",\n      name: \"idMoneda\",\n      items: monedas,\n      valueKey: \"idPais\",\n      labelKey: \"nombreMoneda\",\n      label: \"Moneda\",\n      disabled: allFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormDatePickerField, {\n      namespace: \"model\",\n      name: \"fechaUltimaValuacion\",\n      label: \"Fecha \\xDAltima Valuaci\\xF3n\",\n      disabled: true\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"numeroEscritura\",\n      label: \"Escritura\",\n      disabled: allFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"comentario\",\n      label: \"Comentario\",\n      disabled: allFieldsDisabled\n    })), __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"model\",\n      name: \"numeroNotario\",\n      label: \"Notario\",\n      disabled: allFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormCatalogSelectField, {\n      namespace: \"model\",\n      name: \"claveEstatus\",\n      catalogId: ClavesModuloBienes.Estatus,\n      useLabelAsValue: true,\n      label: \"Estatus\",\n      disabled: allFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(GenericSwitch, {\n      label: \"Revalua\",\n      checked: mode === OperacionesCatalogoDetalleBienes.Revaluacion,\n      disabled: revaluacionFieldsDisabled\n    }))), __jsx(Grid, {\n      container: true,\n      className: classes.rowSpacing,\n      spacing: 3\n    }, __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormTextField, {\n      namespace: \"datosRevaluacion\",\n      name: \"importeRevaluacion\",\n      label: \"Importe Revaluaci\\xF3n\",\n      dataType: \"text\",\n      adornment: \"$\",\n      disabled: revaluacionFieldsDisabled\n    })), __jsx(Grid, {\n      item: true,\n      xs: 6\n    }, __jsx(FormDatePickerField, {\n      namespace: \"datosRevaluacion\",\n      name: \"fechaRevaluacion\",\n      label: \"Fecha Revaluaci\\xF3n\",\n      disabled: revaluacionFieldsDisabled\n    })))));\n  });\n};\n\nexport default DialogDetalleBienes;","map":null,"metadata":{},"sourceType":"module"}