{"ast":null,"code":"import { ModelsApi } from '../../../../core/api';\nimport DetalleBienResultRow from '../models/DetalleBienResultRow';\nimport DetalleBienesModelMapper from './DetalleBienesModelMapper';\nimport { OperacionesCatalogoDetalleBienes } from '../constants';\nimport DateUtils from '../../../../utils/DateUtils';\n\nclass DetalleBienesApi extends ModelsApi {\n  async find(parameters) {\n    return await this.getRef('consultarBienesGar', {\n      Fiso: parameters.idFideicomiso,\n      Subfiso: parameters.idSubcuenta,\n      CveTipoGar: parameters.idTipoBien\n    }, DetalleBienResultRow.fromObject);\n  }\n  /*\r\n   * Se usa este metodo en vez de this.update() para permitir que la logica de negocio\r\n   * se realice en una transacción.\r\n   */\n\n\n  async executeCrudOperation(model, mode, revaluacionDetalleBien) {\n    const esRevaluacion = mode === OperacionesCatalogoDetalleBienes.Revaluacion;\n    const parameters = {\n      detalleBien: JSON.stringify(DetalleBienesModelMapper.toObject(model, esRevaluacion)),\n      tipoOperacion: mode,\n      importeValuacion: revaluacionDetalleBien ? revaluacionDetalleBien.importeRevaluacion : null,\n      fechaValuacion: revaluacionDetalleBien ? DateUtils.fromDate(revaluacionDetalleBien.fechaRevaluacion) : null\n    };\n\n    try {\n      const newDetalleBienId = await this.executeRemoteMethod('funEjecutaOperacionDetalleBienes', parameters);\n      return newDetalleBienId;\n    } catch (error) {\n      throw new Error('Los datos fueron guardados pero el proceso no fue completado. Intente nuevamente');\n    }\n  }\n  /*\r\n   * Se usa este metodo en vez de this.update() para permitir que la logica de negocio\r\n   * se realice en una transacción.\r\n   */\n\n\n  async executeMultipleDeleteOperation(models) {\n    const allPromises = models.reduce((promises, model) => {\n      promises.push(this.executeCrudOperation(model, OperacionesCatalogoDetalleBienes.Salida));\n      return promises;\n    }, []);\n    return this.handleBatchOperation(allPromises, models);\n  }\n\n}\n\nexport const detalleBienesApi = new DetalleBienesApi(DetalleBienesModelMapper);","map":null,"metadata":{},"sourceType":"module"}